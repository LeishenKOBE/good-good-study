# 为什么 setTimeout 有 4 毫秒的延迟

如规范所说：

- 如果设置的 timeout 小于 0，则设置为 0
- 如果嵌套的层级超过了 5 层，并且 timeout 小于 4ms，则设置 timeout 为 4ms

有以下疑问：

1. 各大浏览器的厂商有没有按照规范实现，如果没有是为什么？
2. 4ms 这个数字究竟是如何确定的？

我们先来看各大主流浏览器对 setTimeout 延迟各种边界情况的输出(需要注意的是这里不考虑由于单个 event loop 延迟导致 setTimeout 延迟增加，简化到最原始情况。具体就是不考虑单个 loop 中执行时间过长的情况，假设单个 loop 执行时长小于 ms 级别)：
